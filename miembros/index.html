
<head><!-- Created with <3 by Zero [zerothedragon.com] -->
  <title>Los Armaños</title>
  <meta charset="UTF-8"/>
  <meta name="description" content="Los armaños somos un motoclub familiar con capítulos en Jalisco y Querétaro. Nos gusta salir a rodar con quien sea y cuando sea. Si nos ves en el camino, salúdanos."/>
  <meta property="og:url" content=""/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Los Armaños"/>
  <meta property="og:description" content="Los armaños somos un motoclub familiar con capítulos en Jalisco y Querétaro. Nos gusta salir a rodar con quien sea y cuando sea. Si nos ves en el camino, salúdanos."/>
  <meta property="og:image" content="/images/header.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta property="twitter:domain" content="losarmanos.com"/>
  <meta property="twitter:url" content=""/>
  <meta name="twitter:title" content="Los Armaños"/>
  <meta name="twitter:description" content="Los armaños somos un motoclub familiar con capítulos en Jalisco y Querétaro. Nos gusta salir a rodar con quien sea y cuando sea. Si nos ves en el camino, salúdanos."/>
  <meta name="twitter:image" content="/images/header.jpg"/>
  <link rel="stylesheet" href="/styles.css"/>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
  <link rel="manifest" href="/site.webmanifest"/>
  <meta name="msapplication-TileColor" content="#fafafa"/>
  <meta name="theme-color" content="#2F2D2E"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
</head>
<body>
  <header>
    <ul class="navigation">
      <li><a href="/">Inicio</a></li>
    </ul>
  </header>
  <div class="pageContent"><h2>Miembros</h2>
<p>Esta sección es para mostrar información importante del miembro o prepu para usarse en caso de emergencia. Si hace falta contactar a alguien. Solo presiona el botón de emergencia y manda tu ubicación de GPS</p>
<style>
  .miembro {display: none;}
  .miembro .row {display: flex}
  .miembro .picture {width: 340px; height: 340px; object-fit: cover;}
  .miembro .right {padding-left: 10px}
  .miembro .field {color: var(--danger)}
  .miembro .row {margin-top: 10px}
  .miembro .input {width: 100%; padding: 6px; border: none; margin-bottom: 2px}
  .miembro textarea {height: 100px; resize: none;}
  .miembro .submit {background-color: var(--danger)}
  .miembro .submit:hover {background-color: var(--darkDan)}
  .miembro .pictureHolder {text-align: center;}
  @media screen and (max-width: 699px) {
    .miembro {flex-direction: column;}
    .miembro .right {margin-top: 10px; padding: 0;}
  }
</style>
<div class="preview">Cargando información...</div>
<div class="miembro" id="miembro">
  <div class="pictureHolder">
    <img src="" class="picture" />
  </div>
  <div class="right">
    <span class="field">Nombre</span>
    <span class="name"></span><br/>
    <span class="field">Fecha de nacimiento</span>
    <span class="dob"></span><br/>
    <span class="field">Enfermedades o alergias</span>
    <span class="medicConditions"></span><br/>
    <span class="field">Tipo de sangre</span>
    <span class="bloodType"></span><br/>
    <span class="field">Vehículo(s)</span>
    <span class="vehicle"></span><br/>
    <span class="field">Seguro(s)</span>
    <span class="insurance"></span><br/>
    <div id="form">
      <div class="row">
        <input class="input" type="text" id="contactName" placeholder="Tu nombre"/>
        <input class="input" type="text" id="contactPhone" placeholder="Tu teléfono"/>
      </div>
      <textarea class="input" id="message" placeholder="Escribe aqui la emergencia"></textarea>
      <input class="input submit" id="submit" type="button" value="Notificar Emergencia" />
    </div>
  </div>
</div>
<script>
  const [, uid] = document.location.search.split('=')
  if (uid) {
    fetch(`http://localhost:8081/members/${uid}`).then(response => response.text())
      .then(data => {
        if (!data) return
        document.getElementById('miembro').style.display = 'flex'
        document.querySelector('.preview').style.display = 'none'
        const info = JSON.parse(data)
        const holder = document.getElementById('miembro')
        Object.entries(info).forEach(([key, value]) => {
          if (holder.querySelector(`.${key}`)) holder.querySelector(`.${key}`).innerText = value
        })
        holder.querySelector('.picture').src = info.picture
      })
      .catch(e => {
        console.error(e)
      })
    let location = { error: 'location not allowed' }
    navigator.geolocation.getCurrentPosition(
      ({coords}) => {
        location = {
          accuracy: coords.accuracy,
          latitude: coords.latitude,
          longitude: coords.longitude
        }
      },
      (err) => { alert('Para poder mandar el reporte adecuadamente, por favor activa tu localización') },
      {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0
      }
    )
    document.getElementById('submit').addEventListener('click', () => {
      const author = document.getElementById('contactName').value
      const phone = document.getElementById('contactPhone').value
      const message = document.getElementById('message').value
      if ( !author || !phone || !message ) {
        alert('Tus datos son requeridos')
        return
      }
      document.getElementById('form').innerHTML = '<br/>Gracias por tu notificación, intentaremos localizar a su contacto de emergencia. Es posible que intentemos contactarnos contigo.'
      fetch(`http://localhost:8081/members/${uid}`, {
        method: 'POST',
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          location,
          message: { author, phone, message }
        })
      })
    })
  }
</script>
</div>
  <footer>Los Armaños - Todos los derechos reservados 2023</footer>
</body>